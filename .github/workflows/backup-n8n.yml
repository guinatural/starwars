name: ğŸ” Backup automÃ¡tico do N8N

on:
  schedule:
    - cron: '1 8 * * *' # Executa todos os dias Ã s 18:00 UTC
  workflow_dispatch:     # Permite executar manualmente

jobs:
  backup:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ Clonar repositÃ³rio
        uses: actions/checkout@v3

      - name: ğŸ“‚ Gerar backup zipado
        run: |
          mkdir -p .backup
          zip -r .backup/backup-$(date +'%Y-%m-%d').zip docker/n8n/export.json
          echo "ğŸ§· Backup criado com sucesso!"

      - name: âœ… Commit do backup
        run: |
          git config user.name "SKDVN Bot"
          git config user.email "bot@skdvn.local"
          git add -f .backup/backup-*.zip  # <-- forÃ§a adicionar mesmo se estiver no .gitignore
          git commit -m "ğŸ—‚ Backup automÃ¡tico N8N ($(date +'%Y-%m-%d %H:%M:%S'))" || echo "ğŸ“ Nenhuma alteraÃ§Ã£o para commit"
          git push origin main
